1
2
C::__destruct
3
=================================================================
==2635464==ERROR: AddressSanitizer: stack-buffer-underflow on address 0x7f0563660e18 at pc 0x555f2dcecf0b bp 0x7fff3cd07880 sp 0x7fff3cd07870
WRITE of size 8 at 0x7f0563660e18 thread T0
    #0 0x555f2dcecf0a in sljit_malloc_exec /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/pcre2lib/sljit/sljitExecAllocator.c:300
    #1 0x555f2dcf579e in sljit_generate_code /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/pcre2lib/sljit/sljitNativeX86_common.c:604
    #2 0x555f2de07218 in jit_compile /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/pcre2lib/pcre2_jit_compile.c:14318
    #3 0x555f2de08621 in php_pcre2_jit_compile /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/pcre2lib/pcre2_jit_compile.c:14473
    #4 0x555f2dfd39e8 in pcre_get_compiled_regex_cache_ex /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/php_pcre.c:810
    #5 0x555f2dfd454d in pcre_get_compiled_regex_cache /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/php_pcre.c:896
    #6 0x555f2dfd8ec9 in php_do_pcre_match /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/php_pcre.c:1115
    #7 0x555f2dfdd15b in zif_preg_match /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/php_pcre.c:1467
    #8 0x555f2f3be243 in ZEND_DO_ICALL_SPEC_RETVAL_UNUSED_HANDLER /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_vm_execute.h:1275
    #9 0x555f2f798445 in execute_ex /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_vm_execute.h:57212
    #10 0x555f2f176e3d in zend_call_function /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_execute_API.c:957
    #11 0x555f2f179254 in zend_call_known_function /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_execute_API.c:1051
    #12 0x555f2f8f19bf in zend_call_known_instance_method /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_API.h:853
    #13 0x555f2f8f1a1d in zend_call_known_instance_method_with_0_params /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_API.h:859
    #14 0x555f2f919e25 in zend_std_cast_object_tostring /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_object_handlers.c:1934
    #15 0x555f2f1c1f12 in __zval_get_string_func /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_operators.c:1034
    #16 0x555f2f1c24bf in zval_get_string_func /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_operators.c:1055
    #17 0x555f2ebe8805 in zval_get_tmp_string /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_operators.h:313
    #18 0x555f2ec254c4 in zif_substr_replace /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/standard/string.c:2333
    #19 0x555f2f3bf700 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_vm_execute.h:1337
    #20 0x7f05ac5c330b in zend_jit_trace_execute /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/opcache/jit/zend_jit_vm_helpers.c:889
    #21 0x7f05ac5851b1 in zend_jit_trace_hot_root ext/opcache/jit/zend_jit_trace.c:7738
    #22 0x7f056b68b5ef  (/dev/zero (deleted)+0x80005ef)

Address 0x7f0563660e18 is a wild pointer.
SUMMARY: AddressSanitizer: stack-buffer-underflow /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/pcre/pcre2lib/sljit/sljitExecAllocator.c:300 in sljit_malloc_exec
Shadow bytes around the buggy address:
  0x0fe12c6c4170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe12c6c4180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe12c6c4190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe12c6c41a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe12c6c41b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1
=>0x0fe12c6c41c0: f1 f1 f1[f1]00 f2 f2 f2 00 00 f2 f2 00 00 00 00
  0x0fe12c6c41d0: 00 00 00 00 00 00 f3 f3 f3 f3 00 00 00 00 00 00
  0x0fe12c6c41e0: 00 00 00 00 00 00 00 00 f1 f1 f1 f1 00 00 f2 f2
  0x0fe12c6c41f0: 00 00 00 00 f3 f3 f3 f3 00 00 00 00 00 00 00 00
  0x0fe12c6c4200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0fe12c6c4210: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==2635464==ABORTING