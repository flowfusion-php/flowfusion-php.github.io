int(2)
<?xml version="1.0"?>
<root>
  <fallback-child1/><fallback-child2/>
  
  <keep/>
</root>
string(4) "keep"
<?xml version="1.0"?>
<root>
  <fallback-child1/><fallback-child2/>
  
  <keep>still works</keep>
</root>
array(2) {
  ["a"]=>
  int(1)
  ["A"]=>
  int(2)
}
array(6) {
  ["a"]=>
  int(1)
  ["b"]=>
  int(3)
  ["fusion"]=>
  int(5)
  ["A"]=>
  int(2)
  ["B"]=>
  int(4)
  ["C"]=>
  int(6)
}
array(6) {
  ["a"]=>
  int(1)
  ["b"]=>
  int(3)
  ["fusion"]=>
  int(5)
  ["A"]=>
  int(2)
  ["B"]=>
  int(4)
  ["C"]=>
  int(6)
}
NULL
string(11) "random_var:"
int(1)
array(0) {
}
array(0) {
}
Calling function: umask with arguments: 1
Calling function: stat with arguments: 1
Calling function: trigger_error with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
1, Array
Error calling function trigger_error: trigger_error(): Argument #2 ($error_level) must be of type int, array given
Calling function: ini_get_all with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, 1
Error calling function ini_get_all: ini_get_all(): Argument #1 ($extension) must be of type ?string, array given
Calling function: timezone_name_from_abbr with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array, Array
Error calling function timezone_name_from_abbr: timezone_name_from_abbr(): Argument #1 ($abbr) must be of type string, array given
Calling function: strtoupper with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array
Error calling function strtoupper: strtoupper(): Argument #1 ($string) must be of type string, array given
Calling function: intval with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, 1
Calling function: lchgrp with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array
Error calling function lchgrp: lchgrp(): Argument #1 ($filename) must be of type string, array given
Calling function: phpversion with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array
Error calling function phpversion: phpversion(): Argument #1 ($extension) must be of type ?string, array given
Calling function: scandir with arguments: 1, 1, 1
Error calling function scandir: scandir(): Argument #3 ($context) must be of type resource or null, int given
Calling function: is_countable with arguments: 1
Calling function: checkdnsrr with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
1, Array
Error calling function checkdnsrr: checkdnsrr(): Argument #2 ($type) must be of type string, array given
Calling function: current with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array
Calling function: fscanf with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array, Array

Warning: fscanf(): Argument #3 must be passed by reference, value given in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 41
Error calling function fscanf: fscanf(): Argument #1 ($stream) must be of type resource, array given
Calling function: iterator_to_array with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array
Error calling function iterator_to_array: iterator_to_array(): Argument #2 ($preserve_keys) must be of type bool, array given
Calling function: setrawcookie with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, 1, Array, 1, Array, 1, Array
Error calling function setrawcookie: setrawcookie(): Argument #1 ($name) must be of type string, array given
Calling function: dns_get_record with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array, Array, Array, Array

Warning: dns_get_record(): Argument #3 ($authoritative_name_servers) must be passed by reference, value given in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 41

Warning: dns_get_record(): Argument #4 ($additional_records) must be passed by reference, value given in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 41
Error calling function dns_get_record: dns_get_record(): Argument #1 ($hostname) must be of type string, array given
Calling function: link with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array
Error calling function link: link(): Argument #1 ($target) must be of type string, array given
Calling function: zend_version with arguments: 
Calling function: strftime with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
1, Array

Deprecated: Function strftime() is deprecated in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 41
Error calling function strftime: strftime(): Argument #2 ($timestamp) must be of type ?int, array given
Calling function: scandir with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
1, Array, 1
Error calling function scandir: scandir(): Argument #2 ($sorting_order) must be of type int, array given
Calling function: json_validate with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, 1, Array
Error calling function json_validate: json_validate(): Argument #1 ($json) must be of type string, array given
Calling function: getenv with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array
Error calling function getenv: getenv(): Argument #1 ($name) must be of type ?string, array given
Calling function: trait_exists with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array
Error calling function trait_exists: trait_exists(): Argument #1 ($trait) must be of type string, array given
Calling function: base64_encode with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array
Error calling function base64_encode: base64_encode(): Argument #1 ($string) must be of type string, array given
Calling function: xmlwriter_flush with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38

Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array, Array
Error calling function xmlwriter_flush: xmlwriter_flush(): Argument #1 ($writer) must be of type XMLWriter, array given
Calling function: session_id with arguments: 
Warning: Array to string conversion in /home/phpfuzz/WorkSpace/flowfusion/php-src/tests/fused/fused584.php on line 38
Array
Error calling function session_id: session_id(): Argument #1 ($id) must be of type ?string, array given
=================================================================
==616516==ERROR: AddressSanitizer: heap-use-after-free on address 0x60c000008bc8 at pc 0x559e2b458855 bp 0x7ffe62e52f60 sp 0x7ffe62e52f50
READ of size 4 at 0x60c000008bc8 thread T0
    #0 0x559e2b458854 in dom_objects_free_storage /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/dom/php_dom.c:980
    #1 0x559e2cd1f72a in zend_objects_store_del /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_objects_API.c:200
    #2 0x559e2c6012c3 in rc_dtor_func /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_variables.c:57
    #3 0x559e2c600fa8 in i_zval_ptr_dtor /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_variables.h:44
    #4 0x559e2c6019bd in zval_ptr_dtor /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_variables.c:84
    #5 0x559e2c6bcd0f in _zend_hash_del_el_ex /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_hash.c:1488
    #6 0x559e2c6bd6bb in _zend_hash_del_el /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_hash.c:1515
    #7 0x559e2c6cadaa in zend_hash_graceful_reverse_destroy /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_hash.c:2040
    #8 0x559e2c564597 in zend_shutdown_executor_values /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_execute_API.c:285
    #9 0x559e2c569cc6 in shutdown_executor /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend_execute_API.c:417
    #10 0x559e2c6120f0 in zend_deactivate /home/phpfuzz/WorkSpace/flowfusion/php-src/Zend/zend.c:1290
    #11 0x559e2c270590 in php_request_shutdown /home/phpfuzz/WorkSpace/flowfusion/php-src/main/main.c:1889
    #12 0x559e2d0ff1f7 in do_cli /home/phpfuzz/WorkSpace/flowfusion/php-src/sapi/cli/php_cli.c:1136
    #13 0x559e2d100966 in main /home/phpfuzz/WorkSpace/flowfusion/php-src/sapi/cli/php_cli.c:1340
    #14 0x7f8caafb0d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f)
    #15 0x7f8caafb0e3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f)
    #16 0x559e2ae064f4 in _start (/home/phpfuzz/WorkSpace/flowfusion/php-src/sapi/cli/php+0x2a064f4)

0x60c000008bc8 is located 8 bytes inside of 120-byte region [0x60c000008bc0,0x60c000008c38)
freed by thread T0 here:
    #0 0x7f8cabcaf537 in __interceptor_free ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:127
    #1 0x7f8cab99680b in xmlFreeNodeList (/lib/x86_64-linux-gnu/libxml2.so.2+0x6480b)

previously allocated by thread T0 here:
    #0 0x7f8cabcaf887 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8cab9946f4 in xmlNewNodeEatName (/lib/x86_64-linux-gnu/libxml2.so.2+0x626f4)

SUMMARY: AddressSanitizer: heap-use-after-free /home/phpfuzz/WorkSpace/flowfusion/php-src/ext/dom/php_dom.c:980 in dom_objects_free_storage
Shadow bytes around the buggy address:
  0x0c187fff9120: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fff9130: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c187fff9140: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c187fff9150: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fff9160: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
=>0x0c187fff9170: fa fa fa fa fa fa fa fa fd[fd]fd fd fd fd fd fd
  0x0c187fff9180: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fff9190: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c187fff91a0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c187fff91b0: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa
  0x0c187fff91c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==616516==ABORTING